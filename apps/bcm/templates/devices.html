[[extend 'layout.html']]

<section>
  <div>Select a device role</div>
  <select class="form-select form-select-sm" aria-label=".form-select-sm" name="select_role" 
    @change="select_device_role($event), select_device=null" v-model="select_role">
    <option v-for="role in device_roles" :value="role">{{ role }}</option>
  </select>
  <div>Selected: {{ select_role }}</div>
  <div>Select a device</div>
  <select class="form-select form-select-sm" aria-label=".form-select-sm"
    name="select_device" @change="selected_device($event)" v-model="select_device">
    <option v-for="device in devices_by_role" :value=device.id>{{ device.name }}</option>
  </select>
  <div>Selected: {{ select_device }}</div>
</section>

<div class="section">
  <h5>Device List</h5>
  <div class="vars">
      <table>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Roles</th>
          <th>Commands</th>
          <th>Results</th>
        </tr>
        [[for device in devices:]]
        <tr>
          <td><a href="[[=URL('devices', device['id'])]]">[[=device['id']]]</a></td>
          <td><a href="[[=URL('devices', device['id'])]]">[[=device['name']]]</a></td>
          <td>
          [[for role in device['device_roles']:]]
            <div><a href="[[=URL('roles', role)]]">[[=role]]</a></div>
          [[pass]]
          </td>
          <td>
          [[for command in device['commands']:]]
            <div>[[=command]]:[[=device['commands'][command]]]</div>
          [[pass]]
          </td>
          <td>
            <a href="[[=URL('devices', device['id'], 'partialresults')]]">[[=list(device['results'].keys())]]</a>
          </td>
        </tr>
        [[pass]]
      </table>
  </div>
</div>